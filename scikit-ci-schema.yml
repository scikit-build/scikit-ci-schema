type: map
mapping:
  schema_version:
    type: str
    required: true
    unique: yes
  pre_install: &step
    type: map
    mapping:
      any_ci: &ci
        type: map
        mapping:
          any_os: &os
            type: map
            mapping:
              cmd:
                type: seq
                sequence:
                  - type: str
              environment:
                type: any
          linux: *os
          osx: *os
          windows: *os
      appveyor: *ci
      circle: *ci
      travis: *ci

  install: *step

  pre_build: *step

  build: *step

  test: *step

  after_test: *step
